<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Verification</title>
    <!-- Tailwind CSS CDN for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a clean look */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-gray-800 p-8 rounded-lg shadow-xl max-w-md w-full border border-gray-700">
        <h1 class="text-3xl font-bold text-center mb-6 text-purple-400">Discord Verification</h1>
        <p class="text-gray-400 text-center mb-6">
            Welcome to the verification page for our Discord server. To ensure a fair and secure environment,
            we require a quick verification.
        </p>

        <!-- Privacy Warning and Consent -->
        <div class="bg-red-800 bg-opacity-30 border border-red-700 text-red-300 p-4 rounded-md mb-6 text-sm">
            <p class="font-bold mb-2">⚠️ Important Privacy Notice:</p>
            <p>
                By proceeding, you consent to the collection of your **Discord User ID**, **IP Address**, and a
                **Browser Fingerprint (HWID)**. This data is used solely for anti-alt/multi-account detection
                and server security, similar to services like Double Counter. Your data will be sent to our
                Discord bot via a secure webhook.
            </p>
            <p class="mt-2">
                If you do not agree, please close this page.
            </p>
        </div>

        <div class="mb-4">
            <label for="discordUserId" class="block text-gray-300 text-sm font-bold mb-2">
                Your Discord User ID:
            </label>
            <input type="text" id="discordUserId" placeholder="e.g., 123456789012345678"
                   class="shadow appearance-none border border-gray-600 rounded-md w-full py-2 px-3 bg-gray-700 text-gray-200 leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
            <p class="text-xs text-gray-400 mt-1">
                (Find this by enabling Developer Mode in Discord, right-clicking your name, and selecting 'Copy ID')
            </p>
        </div>

        <div class="mb-6 flex items-center">
            <input type="checkbox" id="consentCheckbox" class="form-checkbox h-5 w-5 text-purple-600 rounded-md focus:ring-purple-500">
            <label for="consentCheckbox" class="ml-2 text-gray-300 text-sm">
                I understand and consent to the data collection as described above.
            </label>
        </div>

        <button id="verifyButton"
                class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg w-full transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-75 disabled:opacity-50 disabled:cursor-not-allowed"
                disabled>
            Verify My Account
        </button>

        <p id="statusMessage" class="text-center mt-4 text-sm"></p>
    </div>

    <script>
        // IMPORTANT: Replace with your actual Discord Webhook URL.
        // Keep this URL as secure as possible. For production, consider a backend proxy.
        const DISCORD_WEBHOOK_URL = 'YOUR_DISCORD_WEBHOOK_URL_HERE'; // e.g., 'https://discord.com/api/webhooks/1234567890/abcdefghijklmnopqrstuvwxyz'

        const discordUserIdInput = document.getElementById('discordUserId');
        const consentCheckbox = document.getElementById('consentCheckbox');
        const verifyButton = document.getElementById('verifyButton');
        const statusMessage = document.getElementById('statusMessage');

        // Function to generate a basic browser fingerprint (HWID)
        // This is a simple, non-robust fingerprint. For stronger fingerprinting,
        // consider dedicated libraries (e.g., FingerprintJS, but be mindful of size for static pages).
        function generateBrowserFingerprint() {
            const userAgent = navigator.userAgent;
            const screenRes = `${screen.width}x${screen.height}x${screen.colorDepth}`;
            const plugins = Array.from(navigator.plugins).map(p => p.name).join(',');
            const languages = navigator.languages ? navigator.languages.join(',') : navigator.language;
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const platform = navigator.platform;
            const hardwareConcurrency = navigator.hardwareConcurrency;
            const deviceMemory = navigator.deviceMemory;

            const components = [
                userAgent, screenRes, plugins, languages, timezone,
                platform, hardwareConcurrency, deviceMemory
            ].filter(Boolean).join('|'); // Filter out null/undefined values

            // Simple hash function (FNV-1a) for demonstration
            let hash = 0x811c9dc5;
            for (let i = 0; i < components.length; i++) {
                hash ^= components.charCodeAt(i);
                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);
            }
            return (hash >>> 0).toString(16); // Convert to unsigned hex string
        }

        // Function to get public IP address
        async function getIpAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('Error fetching IP address:', error);
                return 'Unknown';
            }
        }

        // Enable/disable button based on consent and user ID input
        function updateButtonState() {
            verifyButton.disabled = !consentCheckbox.checked || discordUserIdInput.value.trim() === '';
        }

        consentCheckbox.addEventListener('change', updateButtonState);
        discordUserIdInput.addEventListener('input', updateButtonState);

        verifyButton.addEventListener('click', async () => {
            const discordUserId = discordUserIdInput.value.trim();

            if (discordUserId === '') {
                statusMessage.textContent = 'Please enter your Discord User ID.';
                statusMessage.className = 'text-center mt-4 text-sm text-red-400';
                return;
            }

            if (!consentCheckbox.checked) {
                statusMessage.textContent = 'You must consent to data collection to proceed.';
                statusMessage.className = 'text-center mt-4 text-sm text-red-400';
                return;
            }

            statusMessage.textContent = 'Collecting data and sending... Please wait.';
            statusMessage.className = 'text-center mt-4 text-sm text-yellow-400';
            verifyButton.disabled = true; // Disable button during processing

            const ipAddress = await getIpAddress();
            const hwid = generateBrowserFingerprint();
            const timestamp = new Date().toISOString();

            const payload = {
                discordUserId: discordUserId,
                ipAddress: ipAddress,
                hwid: hwid,
                timestamp: timestamp,
                pageSource: 'Discord Verification Page' // Identify source
            };

            try {
                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: `New verification attempt from Discord User ID: \`${discordUserId}\``,
                        embeds: [{
                            title: "New Verification Attempt",
                            description: `A user has attempted to verify.`,
                            color: 5814783, // Discord purple color
                            fields: [
                                { name: "Discord User ID", value: `\`${discordUserId}\``, inline: false },
                                { name: "IP Address", value: `\`${ipAddress}\``, inline: false },
                                { name: "Browser Fingerprint (HWID)", value: `\`${hwid}\``, inline: false },
                                { name: "Timestamp", value: `\`${timestamp}\``, inline: false }
                            ],
                            footer: { text: "Data collected from verification page." }
                        }]
                    }),
                });

                if (response.ok) {
                    statusMessage.textContent = 'Verification data sent successfully! Please check Discord.';
                    statusMessage.className = 'text-center mt-4 text-sm text-green-400';
                } else {
                    const errorText = await response.text();
                    console.error('Webhook failed:', response.status, errorText);
                    statusMessage.textContent = `Failed to send data. Error: ${response.status}. Please try again later.`;
                    statusMessage.className = 'text-center mt-4 text-sm text-red-400';
                }
            } catch (error) {
                console.error('Network error:', error);
                statusMessage.textContent = 'Network error. Please check your connection and try again.';
                statusMessage.className = 'text-center mt-4 text-sm text-red-400';
            } finally {
                verifyButton.disabled = false; // Re-enable button
            }
        });

        // Initial state update
        updateButtonState();
    </script>
</body>
</html>
